<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button [defaultHref]="'/learn'"></ion-back-button>
      <app-app-logo></app-app-logo>
      <ion-button (click)="navigationService.navigateToPrevious()">
        <ion-icon slot="icon-only" name="chevron-back-outline"></ion-icon>
      </ion-button>
      <ion-button (click)="navigationService.navigateToNext()">
        <ion-icon slot="icon-only" name="chevron-forward-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <div style="display: inline-flex; align-items: center; width: 100%">
      <div *ngIf="(navigationService.status$ | async) let s" style="align-self: center">
        {{s?.currentOrdinal}} / {{s?.totalCount}}, {{s.percent}}%
      </div>

      <!-- <ion-button (click)="window.history.back()"><</ion-button> -->
      <!--        <ion-button routerLink="/learn"><&lt;!&ndash; TODO: create component back-icon &ndash;&gt;</ion-button>-->

      <div style="flex-grow: 1; display: flex; align-items: center">
        <!--          &nbsp; CARD DETAILS-->
      </div>

      <app-time-passing
        style="font-size: 80%; margin-right: 3px"
        [isCountDown]="false"
      ></app-time-passing>

<!--      <app-process-button-->
<!--      ></app-process-button>-->

<!--      <app-quiz-button-->
<!--      ></app-quiz-button>-->

      {{title}}

      <ion-buttons>
        <odm-sync-status-icon style="padding-right: 4px"></odm-sync-status-icon>
      </ion-buttons>

    </div>
<!--    <ion-title>-->
<!--      -->
<!--    </ion-title>-->
  </ion-toolbar>
</ion-header>

<ion-content>

  <ng-container
    *ngIf="(val$ | async) as itemVal else notLoaded"
  >
    <app-breadcrumbs></app-breadcrumbs>
    <app-learn-item-details-hints
      [hidden]="itemVal ?. isTask"
    ></app-learn-item-details-hints>

    CREATED <app-time-point
      [time]="itemVal?.whenCreated?.toDate()"
    ></app-time-point>
    MODIFIED <app-time-point
      [time]="itemVal?.whenLastModified?.toDate()"
    ></app-time-point>

    <app-geo-loc [geoLoc]="itemVal?.whereCreated"></app-geo-loc>

    <div style="display: flex; flex-direction: row; width: 100%">
      <app-item-class-edit
        style="flex-grow: 1"
        [item$]="item$"
      ></app-item-class-edit>
      <app-item-class-to-learn-edit
        style="flex-grow: 1"
        [item$]="item$"
      ></app-item-class-to-learn-edit>
      <!-- TODO:
        - isPublic / isBuiltIn / isOfficial for Vianey for Ukrainian
        - and later draft/beta/published(release) status
          - (which could be same/related to task statuses, thinking that each learn-item is also a task, or has task-workflow)
      -->
      <odm-checkbox
        [fieldName]="'isOfficial'"
        [item$]="item$"
      >OFFICIAL</odm-checkbox>
      <odm-checkbox
        [fieldName]="'isPublished'"
        [item$]="item$"
      >PUBLISHED <!-- TODO store timestamp --></odm-checkbox>

    </div>

    <app-importance-edit
      [item$]="item$"
    ></app-importance-edit>

    <app-fun-level-edit
      [item$]="item$"
    ></app-fun-level-edit>

    <app-mental-effort-level-edit
      [item$]="item$"
    ></app-mental-effort-level-edit>

    <app-physical-health-impact-level-edit
      [item$]="item$"
    ></app-physical-health-impact-level-edit>

    <app-mental-health-impact-level-edit
      [item$]="item$"
    ></app-mental-health-impact-level-edit>

<!--    <app-statuses-edit-->
<!--      [item$]="item$"-->
<!--    ></app-statuses-edit>-->

    <app-self-rating
      [hidden]="itemVal ?. isTask"
      [item$]="item$"
    ></app-self-rating>

    <app-play-button
      [item]="itemVal"
      [itemId]="item$.id"
    ></app-play-button>

    <ion-button (click)="askDelete()">DELETE</ion-button>

    <app-item-sub-items></app-item-sub-items>

    <app-item-side-editor
      *ngFor="let side of sidesDefsArray"
      [item$]="item$"
      [side]="side"
    ></app-item-side-editor>

  </ng-container>

  <ng-template #notLoaded>
    <div style="margin: 20px">Loading...</div>
  </ng-template>

</ion-content>
